<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.3/css/all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

<script class="next-config" data-name="main" type="application/json">{&quot;hostname&quot;:&quot;tzxhy.github.io&quot;,&quot;root&quot;:&quot;&#x2F;&quot;,&quot;images&quot;:&quot;&#x2F;images&quot;,&quot;scheme&quot;:&quot;Mist&quot;,&quot;version&quot;:&quot;8.4.0&quot;,&quot;exturl&quot;:false,&quot;sidebar&quot;:{&quot;position&quot;:&quot;left&quot;,&quot;display&quot;:&quot;post&quot;,&quot;padding&quot;:18,&quot;offset&quot;:12,&quot;b2t&quot;:false,&quot;scrollpercent&quot;:false,&quot;onmobile&quot;:false},&quot;copycode&quot;:false,&quot;bookmark&quot;:{&quot;enable&quot;:false,&quot;color&quot;:&quot;#222&quot;,&quot;save&quot;:&quot;auto&quot;},&quot;fancybox&quot;:true,&quot;mediumzoom&quot;:false,&quot;lazyload&quot;:false,&quot;pangu&quot;:false,&quot;comments&quot;:{&quot;style&quot;:&quot;tabs&quot;,&quot;active&quot;:null,&quot;storage&quot;:true,&quot;lazyload&quot;:false,&quot;nav&quot;:null},&quot;motion&quot;:{&quot;enable&quot;:false,&quot;async&quot;:false,&quot;transition&quot;:{&quot;post_block&quot;:&quot;fadeIn&quot;,&quot;post_header&quot;:&quot;slideDownIn&quot;,&quot;post_body&quot;:&quot;slideDownIn&quot;,&quot;coll_header&quot;:&quot;slideLeftIn&quot;,&quot;sidebar&quot;:&quot;slideUpIn&quot;}},&quot;prism&quot;:false,&quot;i18n&quot;:{&quot;placeholder&quot;:&quot;Searching...&quot;,&quot;empty&quot;:&quot;We didn&#39;t find any results for the search: ${query}&quot;,&quot;hits_time&quot;:&quot;${hits} results found in ${time} ms&quot;,&quot;hits&quot;:&quot;${hits} results found&quot;}}</script>
<meta name="description" content="å…³é”®è¯ï¼š  keyofã€typeof T extends any ? U : Y infer åå˜ã€æŠ—å˜ã€åŒå˜ã€ä¸å˜ï¼ˆæœ€åä¸€ä¸ªæœ¬æ–‡æ²¡æåˆ°ï¼Œå‚è€ƒæ–‡ç« ä¸­æœ‰ï¼‰  ä¸€æ¥å°± show you code~å¦‚æœä¸‹é¢è¿™äº›éƒ½èƒ½çœ‹æ‡‚ä¸”ç†è§£ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ ä¸ç”¨ç»§ç»­çœ‹æœ¬æ–‡äº†ï¼Œsee you next time ğŸ˜„ ~~ 123456789101112131415161718192021222324252627&#x2F;&#x2F; è¿™å‡ ">
<meta property="og:type" content="article">
<meta property="og:title" content="ts æ³›å‹æ·±å…¥">
<meta property="og:url" content="https://tzxhy.github.io/2021/02/09/ts-%E6%B3%9B%E5%9E%8B%E6%B7%B1%E5%85%A5/index.html">
<meta property="og:site_name" content="CMeUp">
<meta property="og:description" content="å…³é”®è¯ï¼š  keyofã€typeof T extends any ? U : Y infer åå˜ã€æŠ—å˜ã€åŒå˜ã€ä¸å˜ï¼ˆæœ€åä¸€ä¸ªæœ¬æ–‡æ²¡æåˆ°ï¼Œå‚è€ƒæ–‡ç« ä¸­æœ‰ï¼‰  ä¸€æ¥å°± show you code~å¦‚æœä¸‹é¢è¿™äº›éƒ½èƒ½çœ‹æ‡‚ä¸”ç†è§£ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ ä¸ç”¨ç»§ç»­çœ‹æœ¬æ–‡äº†ï¼Œsee you next time ğŸ˜„ ~~ 123456789101112131415161718192021222324252627&#x2F;&#x2F; è¿™å‡ ">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-02-08T16:53:50.000Z">
<meta property="article:modified_time" content="2021-05-24T09:30:32.419Z">
<meta property="article:author" content="è°­æ™ºè½©">
<meta property="article:tag" content="æ³›å‹">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://tzxhy.github.io/2021/02/09/ts-%E6%B3%9B%E5%9E%8B%E6%B7%B1%E5%85%A5/">



<script class="next-config" data-name="page" type="application/json">{&quot;sidebar&quot;:&quot;&quot;,&quot;isHome&quot;:false,&quot;isPost&quot;:true,&quot;lang&quot;:&quot;en&quot;,&quot;comments&quot;:true,&quot;permalink&quot;:&quot;https:&#x2F;&#x2F;tzxhy.github.io&#x2F;2021&#x2F;02&#x2F;09&#x2F;ts-%E6%B3%9B%E5%9E%8B%E6%B7%B1%E5%85%A5&#x2F;&quot;,&quot;path&quot;:&quot;2021&#x2F;02&#x2F;09&#x2F;ts-æ³›å‹æ·±å…¥&#x2F;&quot;,&quot;title&quot;:&quot;ts æ³›å‹æ·±å…¥&quot;}</script>

<script class="next-config" data-name="calendar" type="application/json">&quot;&quot;</script>
<title>ts æ³›å‹æ·±å…¥ | CMeUp</title><script src="/js/config.js"></script>
  




  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">CMeUp</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">è®°å½•ä¸€äº›å­¦ä¹ å¿ƒå¾—ï¼ŒQQ:1139723651.</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="home fa-fw"></i>Home</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="tags fa-fw"></i>Tags</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="th fa-fw"></i>Categories</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="archive fa-fw"></i>Archives</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E6%9D%A5%E5%B0%B1-show-you-code"><span class="nav-number">1.</span> <span class="nav-text">ä¸€æ¥å°± show you code~</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#keyof%E3%80%81typeof"><span class="nav-number">2.</span> <span class="nav-text">keyofã€typeof</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#keyof"><span class="nav-number">2.1.</span> <span class="nav-text">keyof</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#typeof"><span class="nav-number">2.2.</span> <span class="nav-text">typeof</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#extends"><span class="nav-number">3.</span> <span class="nav-text">extends</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Distributive-conditional-types"><span class="nav-number">3.1.</span> <span class="nav-text">Distributive conditional types</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#infer"><span class="nav-number">4.</span> <span class="nav-text">infer</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%8F%E5%8F%98%E4%BD%8D%E7%BD%AE%E6%8E%A8%E5%AF%BC"><span class="nav-number">4.1.</span> <span class="nav-text">åå˜ä½ç½®æ¨å¯¼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%97%E5%8F%98%E4%BD%8D%E7%BD%AE%E6%8E%A8%E5%AF%BC"><span class="nav-number">4.2.</span> <span class="nav-text">æŠ—å˜ä½ç½®æ¨å¯¼</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UnionToIntersection%EF%BC%88%E5%A2%99%E8%A3%82%E5%BB%BA%E8%AE%AE%E7%9E%85%E4%B8%80%E5%93%88%EF%BC%89"><span class="nav-number">5.</span> <span class="nav-text">UnionToIntersectionï¼ˆå¢™è£‚å»ºè®®ç…ä¸€å“ˆï¼‰</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%82%E8%80%83"><span class="nav-number">6.</span> <span class="nav-text">å‚è€ƒ</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">è°­æ™ºè½©</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">82</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">30</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">82</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/tzxhy" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;tzxhy" rel="noopener" target="_blank"><i class="github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://juejin.cn/user/1820446984508072" title="æ˜é‡‘ â†’ https:&#x2F;&#x2F;juejin.cn&#x2F;user&#x2F;1820446984508072" rel="noopener" target="_blank">æ˜é‡‘</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.yuque.com/tanzhixuan-zebzs" title="è¯­é›€ â†’ https:&#x2F;&#x2F;www.yuque.com&#x2F;tanzhixuan-zebzs" rel="noopener" target="_blank">è¯­é›€</a>
      </span>
  </div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://tzxhy.github.io/2021/02/09/ts-%E6%B3%9B%E5%9E%8B%E6%B7%B1%E5%85%A5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="è°­æ™ºè½©">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="CMeUp">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ts æ³›å‹æ·±å…¥
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-02-08 16:53:50" itemprop="dateCreated datePublished" datetime="2021-02-08T16:53:50Z">2021-02-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/TypeScript/" itemprop="url" rel="index"><span itemprop="name">TypeScript</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p><strong>å…³é”®è¯</strong>ï¼š</p>
<ul>
<li>keyofã€typeof</li>
<li>T extends any ? U : Y</li>
<li>infer</li>
<li>åå˜ã€æŠ—å˜ã€åŒå˜ã€ä¸å˜ï¼ˆæœ€åä¸€ä¸ªæœ¬æ–‡æ²¡æåˆ°ï¼Œå‚è€ƒæ–‡ç« ä¸­æœ‰ï¼‰</li>
</ul>
<h2 id="ä¸€æ¥å°±-show-you-code"><a href="#ä¸€æ¥å°±-show-you-code" class="headerlink" title="ä¸€æ¥å°± show you code~"></a>ä¸€æ¥å°± show you code~</h2><p>å¦‚æœä¸‹é¢è¿™äº›éƒ½èƒ½çœ‹æ‡‚ä¸”ç†è§£ï¼Œé‚£ä¹ˆæ­å–œä½ ï¼Œä½ ä¸ç”¨ç»§ç»­çœ‹æœ¬æ–‡äº†ï¼Œsee you next time ğŸ˜„ ~~</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¿™å‡ ä¸ªæ˜¯æ ¹æ®å®˜ç½‘çš„ç”¨ä¾‹ï¼Œè‡ªå·±å†™çš„ï¼Œè²Œä¼¼è·Ÿå®˜æ–¹çš„åŸºæœ¬ä¸€è‡´</span></span><br><span class="line"><span class="keyword">type</span> MyPartial&lt;T&gt; = &#123;[U <span class="keyword">in</span> keyof T]?: T[U]&#125;;</span><br><span class="line"><span class="keyword">type</span> MyReadonly&lt;T&gt; = &#123;<span class="keyword">readonly</span> [U <span class="keyword">in</span> keyof T]: T[U]&#125;;</span><br><span class="line"><span class="keyword">type</span> MyRecord&lt;K <span class="keyword">extends</span> keyof <span class="built_in">any</span>, V&gt; = &#123; [Key <span class="keyword">in</span> K]: V&#125;</span><br><span class="line"><span class="keyword">type</span> MyPick&lt;Type, Keys <span class="keyword">extends</span> keyof Type&gt; = &#123;[K <span class="keyword">in</span> Keys]: Type[K]&#125;;</span><br><span class="line"><span class="keyword">type</span> MyExtract&lt;Type, Union&gt; = Union <span class="keyword">extends</span> Type ? Union : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> MyNonNullable&lt;Type&gt; = Type <span class="keyword">extends</span> <span class="built_in">void</span> ? <span class="built_in">never</span> : Type;</span><br><span class="line"><span class="keyword">type</span> MyParameters&lt;Type <span class="keyword">extends</span> (...args: <span class="built_in">any</span>[]) =&gt; <span class="built_in">any</span>&gt; = Type <span class="keyword">extends</span> (...args: infer I) =&gt; <span class="built_in">any</span> ? (I) : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> MyConstructorParameters&lt;Type&gt; = Type <span class="keyword">extends</span> <span class="keyword">new</span> (...args: infer I) =&gt; <span class="built_in">any</span> ? (I) : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> MyReturnType&lt;Func&gt; = Func <span class="keyword">extends</span> (...args: <span class="built_in">any</span>[]) =&gt; infer R ? R : <span class="built_in">never</span>;</span><br><span class="line"><span class="comment">// ä¸‹é¢è¿™äº›æ˜¯æ–‡ç«  &quot;ts ç–‘éš¾æ‚ç—‡&quot; ä¸­æ‹·è´è¿‡æ¥çš„</span></span><br><span class="line"><span class="keyword">type</span> PromiseInnerType&lt;T <span class="keyword">extends</span> <span class="built_in">Promise</span>&lt;<span class="built_in">any</span>&gt;&gt; = T <span class="keyword">extends</span> <span class="built_in">Promise</span>&lt;infer P&gt;</span><br><span class="line">  ? P</span><br><span class="line">  : <span class="built_in">never</span></span><br><span class="line"><span class="comment">// string</span></span><br><span class="line"><span class="keyword">type</span> Test = PromiseInnerType&lt;<span class="built_in">Promise</span>&lt;<span class="built_in">string</span>&gt;&gt;</span><br><span class="line"><span class="comment">// è”åˆç±»å‹æ”¹ä¸ºäº¤å‰ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> UnionToIntersection&lt;U&gt; = (U <span class="keyword">extends</span> <span class="built_in">any</span></span><br><span class="line">  ? <span class="function">(<span class="params">k: U</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  : <span class="built_in">never</span>) <span class="keyword">extends</span> (<span class="function">(<span class="params">k: infer I</span>) =&gt;</span> <span class="built_in">void</span>)</span><br><span class="line">  ? I</span><br><span class="line">  : <span class="built_in">never</span></span><br><span class="line"><span class="comment">// &#123; a: string &#125; | &#123; b: number &#125; =&gt; &#123; a: string &#125; &amp; &#123; b: number &#125;</span></span><br><span class="line"><span class="keyword">type</span> Test = UnionToIntersection&lt;&#123; <span class="attr">a</span>: <span class="built_in">string</span> &#125; | &#123; <span class="attr">b</span>: <span class="built_in">number</span> &#125;&gt;</span><br><span class="line"><span class="keyword">type</span> Prettify&lt;T&gt; = T <span class="keyword">extends</span> infer U ? &#123; [K <span class="keyword">in</span> keyof U]: U[K] &#125; : <span class="built_in">never</span></span><br><span class="line"><span class="comment">// &#123; a: string; b: number; c: boolean &#125;</span></span><br><span class="line"><span class="keyword">type</span> Param = Prettify&lt;&#123; <span class="attr">a</span>: <span class="built_in">string</span> &#125; &amp; &#123; <span class="attr">b</span>: <span class="built_in">number</span> &#125; &amp; &#123; <span class="attr">c</span>: <span class="built_in">boolean</span> &#125;&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæœ‰ä¸€ä¸¤ä¸ªä¸æ‡‚çš„ï¼Œé‚£ä¹ˆè¯·ç‚¹å‡»ç›®å½•å¿«é€Ÿè¿›å…¥ä½ æƒ³ç…ä¸€ä¸‹çš„~</p>
<hr>
<span id="more"></span>

<h2 id="keyofã€typeof"><a href="#keyofã€typeof" class="headerlink" title="keyofã€typeof"></a>keyofã€typeof</h2><p>è¿™ä¸¤ä¸ªå…³é”®å­—æ¯”è¾ƒåŸºç¡€äº†ï¼Œä¸¤ç§å§¿åŠ¿ç®€å•äº†è§£ä¸€ä¸‹ï¼š</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/2/keyof-types.html#the-keyof-type-operator">keyof å®˜ç½‘ä»‹ç»</a>ï¼Œ<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/2/typeof-types.html">typeof å®˜ç½‘ä»‹ç»</a></li>
<li>å¬æˆ‘ç®€å•é€¼é€¼ä¸€ä¸‹~~</li>
</ol>
<h3 id="keyof"><a href="#keyof" class="headerlink" title="keyof"></a>keyof</h3><p>è·å–ç±»å‹ T çš„æ‰€æœ‰ key çš„ç±»å‹<strong>é›†åˆ</strong>ï¼ˆæ³¨æ„æˆ‘å˜é‡äº†ï¼Œè¿”å›çš„æ˜¯<strong>é›†åˆ</strong>ï¼‰ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Point = &#123; <span class="attr">x</span>: <span class="built_in">number</span>; y: <span class="built_in">number</span> &#125;;</span><br><span class="line"><span class="keyword">type</span> P = keyof Point;</span><br><span class="line"><span class="comment">//   ^ x | y  Point åªæœ‰ä¸¤ä¸ª key</span></span><br><span class="line"><span class="keyword">type</span> Mapish = &#123; [k: <span class="built_in">string</span>]: <span class="built_in">boolean</span> &#125;;</span><br><span class="line"><span class="keyword">type</span> M = keyof Mapish;</span><br><span class="line"><span class="comment">//   ^number | string   ä¸ºå•¥ï¼Ÿ</span></span><br><span class="line"><span class="keyword">type</span> KeyOfAny = keyof <span class="built_in">any</span>;</span><br><span class="line"><span class="comment">//   ^ string | number | symbol   å•Šï¼Ÿ</span></span><br></pre></td></tr></table></figure>

<p>Mapish ä¸­å¹¶æ²¡æœ‰ numberï¼ŒM ä¸ºå•¥æ˜¯ number | string ï¼Ÿå› ä¸º js ä¸­ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> obj = &#123;&#125;;</span><br><span class="line"><span class="comment">// ä½ å¯ä»¥ æ•° ç€è®¿é—®</span></span><br><span class="line">obj[<span class="number">0</span>];</span><br><span class="line"><span class="comment">// è¿˜å¯ä»¥ ä¸² ç€è®¿é—®</span></span><br><span class="line">obj[<span class="string">&#x27;0&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>KeyOfAny ä¸ºå•¥æ˜¯è¿™ä¸ªç»“æœï¼Ÿkeyof æœ¬èº«ä½œä¸ºè·å–ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰ key ç±»å‹çš„å…³é”®å­—ï¼Œæœ¬èº«æ˜¯é’ˆå¯¹å¯¹è±¡çš„ã€‚è€Œè®¿é—®ä¸€ä¸ªå¯¹è±¡ï¼Œè‡ªç„¶å¯ä»¥é€šè¿‡è¿™3ç§ key æ¥è®¿é—®ã€‚So ï¼Œå°±è¿™æ ·äº†ã€‚ä¹Ÿå¯ä»¥å‚è€ƒè¿™ä¸ª<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/55535598/why-does-keyof-any-have-type-of-string-number-symbol-in-typescript">é—®é¢˜</a>ã€‚</p>
<h3 id="typeof"><a href="#typeof" class="headerlink" title="typeof"></a>typeof</h3><p>æ³¨æ„éœ€è¦è·Ÿ js å†…ç½®çš„ typeof åŒºåˆ†å¼€ã€‚ts ä¸­çš„ typeof åè·Ÿä¸€ä¸ªå…·ä½“å€¼ï¼Œç”¨äºè·å–è¿™ä¸ªå€¼çš„ç±»å‹ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> s = <span class="string">&quot;hello&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> n: <span class="keyword">typeof</span> s;</span><br><span class="line"><span class="comment">//  ^string</span></span><br><span class="line"><span class="keyword">let</span> f = <span class="function">(<span class="params">name: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">type</span> TypeF = <span class="keyword">typeof</span> f;</span><br><span class="line"><span class="comment">//   ^(name: string) =&gt; number</span></span><br></pre></td></tr></table></figure>

<p>æ¯”è¾ƒç®€å•ï¼Œä¸å¤šç¼©~</p>
<hr>
<h2 id="extends"><a href="#extends" class="headerlink" title="extends"></a>extends</h2><p>è¿™é‡Œè¯´çš„ extends ä¸æ˜¯ interfaceã€class çš„ç»§æ‰¿ï¼Œè€Œæ˜¯æ³›å‹ç›¸å…³éªšæ“ä½œä¸­ extends ~</p>
<p>æœ€æ—©çš„æ³›å‹ extends æ˜¯åœ¨ ts1.8 ä¸­å¼•å…¥çš„ï¼Œ<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-1-8.html#type-parameters-as-constraints">é“¾æ¥</a>åœ¨è¿™ã€‚ æœ€å¼€å§‹è¿™ä¸ªæ˜¯ç”¨æ¥é™åˆ¶æ³›å‹ç±»å‹çš„ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">assign</span>&lt;<span class="title">T</span> <span class="title">extends</span> <span class="title">U</span>, <span class="title">U</span>&gt;(<span class="params">target: T, source: U</span>): <span class="title">T</span> </span>&#123;</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> id <span class="keyword">in</span> source) &#123;</span><br><span class="line">    target[id] = source[id];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> target;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> x = &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span>, <span class="attr">c</span>: <span class="number">3</span>, <span class="attr">d</span>: <span class="number">4</span> &#125;;</span><br><span class="line">assign(x, &#123; <span class="attr">b</span>: <span class="number">10</span>, <span class="attr">d</span>: <span class="number">20</span> &#125;);</span><br><span class="line">assign(x, &#123; <span class="attr">e</span>: <span class="number">0</span> &#125;); <span class="comment">// Error</span></span><br></pre></td></tr></table></figure>

<p>ç”¨äºé™åˆ¶æ³›å‹ç±»å‹æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œä½†ç»“åˆå…¶ä»–ä¸œè¥¿ï¼Œå°±æœ‰ç‚¹ä¸œè¥¿äº†ï¼Œå¾€ä¸‹~</p>
<p>åœ¨ <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html#conditional-types">ts 2.8</a> ä¸­å¼•å…¥äº† <strong>Conditional Types</strong> ï¼Œè¿™é‡Œå»ºè®®å¤§å®¶è¿˜æ˜¯è¯»ä¸€ä¸‹æ–‡æ¡£ï¼Œå¾ˆé‡è¦ï¼æˆ‘è¿™è¾…åŠ©ç¿»è¯‘ä¸€ä¸‹ï¼Œè¡¨å–·ç¿»è¯‘èƒ½åŠ›~~ï¼š</p>
<blockquote>
<p>æ¡ä»¶ç±»å‹ T extends U ? X : Y ä¼šè¢«ç›´æ¥æ¨å¯¼ä¸º X æˆ–è€… Yï¼Œä¹Ÿå¯èƒ½ç”±äºæ¡ä»¶ä¾èµ–æ›´å¤šçš„ç±»å‹è€Œè¢«æ¨è¿Ÿæ¨å¯¼ã€‚æ˜¯å¦ç›´æ¥æ¨å¯¼æˆ–è€…å»¶è¿Ÿæ¨å¯¼ï¼Œå–å†³äºï¼š</p>
<ol>
<li>é¦–å…ˆï¼Œç»™å®šç±»å‹ Tâ€™ å’Œ Uâ€™ï¼Œä»–ä»¬åˆ†åˆ«æ˜¯ç±»å‹ T å’Œ U çš„å®ä¾‹ï¼ˆå¦‚æœ Tã€U æœ‰ç±»å‹å‚æ•°ï¼Œç”¨ any æ›¿æ¢ï¼‰ï¼Œå¦‚æœ Tâ€™ ä¸èƒ½è¢«åˆ†é…ç»™ Uâ€™ï¼Œé‚£ä¹ˆæœ‰æ¡ä»¶ç±»å‹æœ€ç»ˆè¢«æ¨å¯¼ä¸º Yã€‚ç›´è§‰ä¸Šï¼Œå¦‚æœ T çš„æœ€å¤§åŒ–å®ä¾‹éƒ½ä¸èƒ½åˆ†é…ç»™ U çš„æœ€å¤§åŒ–å®ä¾‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¼šç›´æ¥æ¨å¯¼ä¸º Yã€‚</li>
<li>æ¥ä¸‹æ¥ï¼Œå¯¹äº U ä¸­çš„æ¨æ–­(infer å…³é”®å­—)å£°æ˜å¼•å…¥çš„æ¯ä¸ªç±»å‹å˜é‡ï¼Œé€šè¿‡ä»Tæ¨æ–­åˆ°Uï¼ˆä½¿ç”¨ä¸æ³›å‹å‡½æ•°çš„ç±»å‹æ¨æ–­ç›¸åŒçš„æ¨æ–­ç®—æ³•ï¼‰æ¥æ”¶é›†ä¸€ç»„å€™é€‰ç±»å‹ã€‚å¯¹äºç»™å®šçš„æ¨æ–­ç±»å‹ Vï¼Œå¦‚æœæœ‰ä»»æ„å€™é€‰ç±»å‹ä»åå˜ä½ç½®æ¨æ–­å‡ºï¼Œé‚£ä¹ˆæ¨æ–­ç±»å‹ V æ˜¯è¿™äº›å€™é€‰ç±»å‹çš„å¹¶é›†ï¼›ä¸ç„¶ï¼Œå¦‚æœæœ‰ä»»æ„å€™é€‰ä»æŠ—å˜ä½ç½®æ¨æ–­å‡ºï¼Œæ¨æ–­ç±»å‹ V æ˜¯è¿™äº›å€™é€‰ç±»å‹çš„äº¤é›†ï¼›å¦åˆ™ï¼Œç±»å‹V å°±æ˜¯ neverã€‚</li>
<li>ç„¶åï¼Œç»™å®šä¸€ä¸ªç±»å‹ T çš„å®ä¾‹ Tâ€™â€™ï¼Œå…¶ä¸­æ‰€æœ‰æ¨æ–­ç±»å‹å˜é‡éƒ½æ›¿æ¢ä¸ºä¸Šä¸€æ­¥ä¸­æ¨æ–­çš„ç±»å‹Vï¼Œå¦‚æœTâ€™â€™ç»å¯¹èƒ½åˆ†é…ç»™Uï¼Œé‚£ä¹ˆæ¨å¯¼ä¸º Xã€‚é™¤äº†æ²¡è€ƒè™‘ç±»å‹å˜é‡ä»¥å¤–ï¼Œç»å¯¹åˆ†é…å…³ç³»ä¸å¸¸è§„çš„åˆ†é…å…³ç³»ä¸€è‡´ã€‚ç›´è§‰ä¸Šæ¥è¯´ï¼Œå½“ä¸€ä¸ªç±»å‹ç»å¯¹èƒ½åˆ†é…åˆ°å¦ä¸€ä¸ªç±»å‹ä¸Šæ—¶ï¼Œæˆ‘ä»¬è¯´å®ƒèƒ½åˆ†é…åˆ°é‚£äº›ç±»å‹çš„æ‰€æœ‰å®ä¾‹ä¸Šã€‚</li>
<li>æœ€åï¼Œæ¡ä»¶ç±»å‹ä¾èµ–æ›´å¤šçš„ç±»å‹å˜é‡ï¼Œé‚£ä¹ˆç±»å‹æ¨å¯¼è¢«æ¨è¿Ÿã€‚</li>
</ol>
</blockquote>
<p>å…¶å®ä¸å¤ªå¥½ç†è§£æ˜¯ä¸æ˜¯ï¼Ÿè¿˜æ˜¯çœ‹æ —å­æ¯”è¾ƒå®¹æ˜“æ‡‚ã€‚ï¼ˆåå˜ä½ç½®ã€æŠ—å˜ä½ç½®è¿™ä¸ªæ¦‚å¿µåœ¨ infer ä¸€èŠ‚ä¸­è¯´å“ˆï¼Œè¿™é‡Œå…ˆå¿½ç•¥ï¼‰</p>
<p>æˆ‘ä»¬å¯ä»¥å…ˆåªçœ‹ç¬¬ä¸€ç‚¹ï¼Œåé¢çš„2ã€3ã€4éƒ½æ˜¯é’ˆå¯¹ infer çš„ï¼ˆè¿˜æ˜¯æ‹¿å®˜ç½‘çš„æ —å­ï¼‰ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> TypeName&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">string</span></span><br><span class="line">  ? <span class="string">&quot;string&quot;</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="built_in">number</span></span><br><span class="line">  ? <span class="string">&quot;number&quot;</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="built_in">boolean</span></span><br><span class="line">  ? <span class="string">&quot;boolean&quot;</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="literal">undefined</span></span><br><span class="line">  ? <span class="string">&quot;undefined&quot;</span></span><br><span class="line">  : T <span class="keyword">extends</span> <span class="built_in">Function</span></span><br><span class="line">  ? <span class="string">&quot;function&quot;</span></span><br><span class="line">  : <span class="string">&quot;object&quot;</span>;</span><br><span class="line"><span class="keyword">type</span> T0 = TypeName&lt;<span class="built_in">string</span>&gt;; <span class="comment">// &quot;string&quot;</span></span><br><span class="line"><span class="keyword">type</span> T1 = TypeName&lt;<span class="string">&quot;a&quot;</span>&gt;; <span class="comment">// &quot;string&quot;</span></span><br><span class="line"><span class="keyword">type</span> T2 = TypeName&lt;<span class="literal">true</span>&gt;; <span class="comment">// &quot;boolean&quot;</span></span><br><span class="line"><span class="keyword">type</span> T3 = TypeName&lt;<span class="function">() =&gt;</span> <span class="built_in">void</span>&gt;; <span class="comment">// &quot;function&quot;</span></span><br><span class="line"><span class="keyword">type</span> T4 = TypeName&lt;<span class="built_in">string</span>[]&gt;; <span class="comment">// &quot;object&quot;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>T0 ä¸­ï¼Œstring extends string ä¸º trueï¼Œæ‰€ä»¥è¿”å› â€˜stringâ€™ï¼›</li>
<li>T1 ä¸­ï¼Œâ€™aâ€™ æ˜¯ string çš„ä¸€ä¸ªå®ä¾‹åŒ–ï¼Œå°±æ˜¯ç¬¬ä¸€ç‚¹ä¸­è¯´çš„Tâ€™ï¼Œæ­¤æ—¶Uâ€™æ˜¯æ‰€æœ‰å­—ç¬¦ä¸²çš„å®ä¾‹åŒ–ä»£è¡¨ï¼Œæ‰€ä»¥ â€˜aâ€™ è‚¯å®šèƒ½å©šé…ç»™ stringï¼Œæ‰€ä»¥è¿”å› â€˜stringâ€™ï¼›</li>
<li>T2 ä¸­ï¼Œ åŒç†ï¼Œtrue æ˜¯ boolean çš„å®ä¾‹åŒ–ï¼ŒSo~</li>
<li>T3 - T4ï¼ŒåŒç† tooã€‚</li>
</ul>
<p>å¯ä»¥é¡ºç€çœ‹ä¸€ä¸‹åˆ†å¸ƒæ¡ä»¶ç±»å‹ï¼Œå†çœ‹ infer~</p>
<h3 id="Distributive-conditional-types"><a href="#Distributive-conditional-types" class="headerlink" title="Distributive conditional types"></a>Distributive conditional types</h3><p>[æ–‡æ¡£ã€‘(<a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html#distributive-conditional-types">https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html#distributive-conditional-types</a>)</p>
<p>æˆ‘æŠŠè¿™ä¸ªåˆ†å¸ƒæ¡ä»¶ç±»å‹ä¹Ÿæ”¾å…¥ extends å°èŠ‚é‡Œã€‚</p>
<blockquote>
<p>è¢«é€‰ä¸­çš„ç±»å‹ä¸ºè£¸ç±»å‹å‚æ•°çš„æ¡ä»¶ç±»å‹ç§°ä¸ºåˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼ˆå³æ²¡æœ‰è¢«è¯¸å¦‚æ•°ç»„ï¼Œå…ƒç»„æˆ–è€…å‡½æ•°åŒ…è£¹ï¼‰ã€‚ å®ä¾‹åŒ–æœŸé—´ï¼Œåˆ†å¸ƒæ¡ä»¶ç±»å‹è‡ªåŠ¨åˆ†å¸ƒåœ¨è”åˆç±»å‹ä¸Šã€‚ ä¾‹å¦‚ï¼ŒT extends U ? X : Yï¼Œç±»å‹å‚æ•°ä¸º A | B | C ï¼Œçš„ T è§£æä¸º(A extends U ? X : Y) | (B extends U ? X : Y) | (C extends U ? X : Y)</p>
</blockquote>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> BoxedValue&lt;T&gt; = &#123; <span class="attr">value</span>: T &#125;;</span><br><span class="line"><span class="keyword">type</span> BoxedArray&lt;T&gt; = &#123; <span class="attr">array</span>: T[] &#125;;</span><br><span class="line"><span class="keyword">type</span> Boxed&lt;T&gt; = T <span class="keyword">extends</span> <span class="built_in">any</span>[] ? BoxedArray&lt;T[<span class="built_in">number</span>]&gt; : BoxedValue&lt;T&gt;;</span><br><span class="line"><span class="keyword">type</span> T20 = Boxed&lt;<span class="built_in">string</span>&gt;; <span class="comment">// BoxedValue&lt;string&gt;;</span></span><br><span class="line"><span class="keyword">type</span> T21 = Boxed&lt;<span class="built_in">number</span>[]&gt;; <span class="comment">// BoxedArray&lt;number&gt;;</span></span><br><span class="line"><span class="keyword">type</span> T22 = Boxed&lt;<span class="built_in">string</span> | <span class="built_in">number</span>[]&gt;; <span class="comment">// BoxedValue&lt;string&gt; | BoxedArray&lt;number&gt;;</span></span><br><span class="line"><span class="keyword">type</span> T23 = Boxed&lt;<span class="built_in">string</span>&gt; | Boxed&lt;<span class="built_in">number</span>[]&gt;; <span class="comment">// BoxedValue&lt;string&gt; | BoxedArray&lt;number&gt;;</span></span><br></pre></td></tr></table></figure>

<p>T22 è”åˆç±»å‹ï¼Œå°±ç­‰äºåˆ†å¼€åå†è”åˆï¼Œå°±ç­‰äº T23ã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ BoxedArray&lt;T[number]&gt; è¿™ç§å†™æ³•ï¼šå› ä¸º T å·²ç»æœ‰äº† any[] çš„åŸºç±»å‹ï¼Œè¯´æ˜ T è‚¯å®šæ˜¯ä¸€ä¸ªæ•°ç»„ã€‚æ˜¯æ•°ç»„çš„è¯ï¼Œå°±å¯ä»¥ç”¨ number ç±»å‹çš„ç´¢å¼•å»è®¿é—®ï¼Œæ¯”å¦‚T[0]ã€T[1]ç­‰ï¼Œå› æ­¤ä¹Ÿå¯ä»¥å†™æˆ BoxedArray&lt;T[0]&gt; ã€‚ä¸è¿‡ä¹Ÿæœ‰å·®å¼‚ï¼Œå†™æˆ T[0] çš„å½¢å¼ï¼Œå°±æ˜ç¡®åªè¦ 0ç´¢å¼•çš„ç±»å‹ï¼›å†™æˆ T[number]ï¼Œå°±è¡¨æ˜éœ€è¦æ‰€æœ‰ç±»å‹çš„è”åˆç±»å‹ã€‚è¿™ç‚¹éœ€è¦æ³¨æ„ã€‚</p>
<p>ç‹™ä¸€ç¿»ä¸‰ï¼Œå¦‚æœæ˜¯å¯¹è±¡ç±»å‹çš„è¯ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Boxed2&lt;T&gt; = T <span class="keyword">extends</span> Record&lt;<span class="built_in">string</span>, <span class="built_in">number</span>&gt; ? BoxedArray&lt;T[<span class="built_in">string</span>]&gt; : BoxedValue&lt;T&gt;;</span><br><span class="line"><span class="keyword">type</span> T24 = Boxed2&lt;&#123;[key: <span class="built_in">string</span>]: <span class="built_in">number</span>&#125;&gt; <span class="comment">// BoxedArray&lt;number&gt;</span></span><br><span class="line"><span class="keyword">type</span> T25 = Boxed2&lt;&#123;[key: <span class="built_in">string</span>]: <span class="built_in">string</span>&#125;&gt; <span class="comment">// BoxedArray&lt;&#123;[key: string]: string&#125;&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="infer"><a href="#infer" class="headerlink" title="infer"></a>infer</h2><p>åŒæ ·æ˜¯ <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-8.html#type-inference-in-conditional-types">ts2.8</a> æå‡ºçš„ã€‚</p>
<p>infer å…³é”®å­—åªèƒ½åœ¨ extends è¯­å¥ä¸­ä½¿ç”¨ï¼Œè¡¨æ˜ä¸€ä¸ªéœ€è¦æ¨å¯¼çš„ç±»å‹ã€‚å¯¹åŒä¸€ä¸ªç±»å‹å¯ä»¥è¿›è¡Œå¤šæ¬¡ infer æ¨å¯¼ã€‚</p>
<p>æ¯”å¦‚ï¼Œ2.8ä¸­æ–°å¢çš„ ReturnType:</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> ReturnType&lt;T&gt; = T <span class="keyword">extends</span> (...args: <span class="built_in">any</span>[]) =&gt; infer R ? R : <span class="built_in">any</span>;</span><br></pre></td></tr></table></figure>

<p>ReturnTypeç”¨äºè·å–ä¸€ä¸ªå‡½æ•°çš„è¿”å›ç±»å‹ï¼Œä¸Šé¢çš„æ„æ€æ˜¯ï¼šå¦‚æœ T å¯ä»¥åˆ†é…ç»™ (â€¦args: any[]) =&gt; infer R è¿™ç§ç±»å‹çš„å‡½æ•°çš„è¯ï¼Œé‚£ä¹ˆè¿”å›ç±»å‹ Rï¼Œå¦åˆ™è¿”å› anyã€‚åœ¨è¿™é‡Œè¿”å›ç”¨äº†infer R ä»£è¡¨éœ€è¦æ¨æ–­ç±»å‹ Rã€‚</p>
<p>åŒæ ·ï¼Œä¹Ÿèƒ½â€œæ— é™ extendsâ€ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Unpacked&lt;T&gt; = T <span class="keyword">extends</span> (infer U)[]</span><br><span class="line">  ? U</span><br><span class="line">  : T <span class="keyword">extends</span> (...args: <span class="built_in">any</span>[]) =&gt; infer U</span><br><span class="line">  ? U</span><br><span class="line">  : T <span class="keyword">extends</span> <span class="built_in">Promise</span>&lt;infer U&gt;</span><br><span class="line">  ? U</span><br><span class="line">  : T;</span><br></pre></td></tr></table></figure>



<p><strong>æœ¬æ–‡é«˜æ½®</strong> è¦æ¥äº†ï¼Œå¤§å®¶åˆ«å«å•Šï¼</p>
<h3 id="åå˜ä½ç½®æ¨å¯¼"><a href="#åå˜ä½ç½®æ¨å¯¼" class="headerlink" title="åå˜ä½ç½®æ¨å¯¼"></a>åå˜ä½ç½®æ¨å¯¼</h3><p>ä¸‹é¢çš„ä¾‹å­é˜é‡Šäº†ï¼šåœ¨<strong>åå˜ä½ç½®</strong>å¯¹äº<strong>åŒä¸€ä¸ªç±»å‹å˜é‡</strong>çš„<strong>å¤šä¸ªå€™é€‰ç±»å‹</strong>å¦‚ä½•æ¨å¯¼å‡ºä¸€ä¸ª<strong>è”åˆç±»å‹</strong>ã€‚ï¼ˆä½ ä¸‘ï¼Œè¿™é‡Œè¿™ä¹ˆå¤šä¸ª bold æ–‡å­—ï¼Œæ˜¯ä¸æ˜¯å¾ˆé‡è¦ï¼Ÿï¼‰çœ‹ä¸æ‡‚ï¼Ÿæ²¡å…³ç³»ï¼Œåé¢è¦è¯´ã€‚</p>
<p>è¿˜æ˜¯å®˜æ–¹çš„ä¾‹å­ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Foo&lt;T&gt; = T <span class="keyword">extends</span> &#123; <span class="attr">a</span>: infer U; b: infer U &#125; ? U : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> T10 = Foo&lt;&#123; <span class="attr">a</span>: <span class="built_in">string</span>; b: <span class="built_in">string</span> &#125;&gt;; <span class="comment">// string</span></span><br><span class="line"><span class="keyword">type</span> T11 = Foo&lt;&#123; <span class="attr">a</span>: <span class="built_in">string</span>; b: <span class="built_in">number</span> &#125;&gt;; <span class="comment">// string | number</span></span><br></pre></td></tr></table></figure>

<p>çœ‹è¿™é‡Œï¼ŒFoo åˆ¤æ–­ Tæ˜¯å¦å¯å©šé…ç»™ { a: infer U; b: infer U }ï¼Œè¿™é‡Œ U æ˜¯ key a å’Œ bçš„æ¨å¯¼ç±»å‹ã€‚</p>
<p>T10 ä¸­çš„ a å’Œ b éƒ½æ˜¯ stringï¼Œå“¦è€¶ï¼ŒFoo å°±ç›´æ¥æ˜¯ stringï¼Œno problemï¼</p>
<p>T11 ä¸­çš„ a æ˜¯string å’Œ b æ˜¯ numberï¼Œå“¦è€¶ï¼ŒFoo å°±ç›´æ¥æ˜¯ string å’Œ number çš„è”åˆç±»å‹ï¼ˆä¹Ÿå°±æ˜¯string | numberï¼‰ï¼ä¸ºå•¥ï¼Ÿå› ä¸ºå°±æ˜¯ts2.8ä¸­çš„ infer å°±è¿™ä¹ˆè®¾è®¡çš„ï¼ï¼ï¼</p>
<p>è¿™é‡Œéœ€è¦å…ˆè¯´æ˜ä¸€ä¸‹ï¼š<strong>å¯¹è±¡å‹ç±»å‹éƒ½å¯å½“åšæ˜¯åå˜ç±»å‹</strong>ã€‚ï¼ˆå…·ä½“åŸå› çœ‹ä¸€ä¸‹å‚è€ƒæ–‡ç« ï¼Œæœ‰å…´è¶£çš„çœ‹ä¸‹å°± O98Kï¼‰</p>
<h3 id="æŠ—å˜ä½ç½®æ¨å¯¼"><a href="#æŠ—å˜ä½ç½®æ¨å¯¼" class="headerlink" title="æŠ—å˜ä½ç½®æ¨å¯¼"></a>æŠ—å˜ä½ç½®æ¨å¯¼</h3><p>åœ¨<strong>æŠ—å˜ä½ç½®</strong>å¯¹äº<strong>åŒä¸€ä¸ªç±»å‹å˜é‡</strong>çš„<strong>å¤šä¸ªå€™é€‰ç±»å‹</strong>å¦‚ä½•æ¨å¯¼å‡ºä¸€ä¸ª<strong>äº¤é›†ç±»å‹</strong>ã€‚ï¼ˆæ³¨æ„åŒºåˆ«äºåå˜ä½ç½®çš„è”åˆç±»å‹ï¼‰</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Bar&lt;T&gt; = T <span class="keyword">extends</span> &#123; <span class="attr">a</span>: <span class="function">(<span class="params">x: infer U</span>) =&gt;</span> <span class="built_in">void</span>; b: <span class="function">(<span class="params">x: infer U</span>) =&gt;</span> <span class="built_in">void</span> &#125;</span><br><span class="line">  ? U</span><br><span class="line">  : <span class="built_in">never</span>;</span><br><span class="line"><span class="keyword">type</span> T20 = Bar&lt;&#123; <span class="attr">a</span>: <span class="function">(<span class="params">x: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>; b: <span class="function">(<span class="params">x: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span> &#125;&gt;; <span class="comment">// string</span></span><br><span class="line"><span class="keyword">type</span> T21 = Bar&lt;&#123; <span class="attr">a</span>: <span class="function">(<span class="params">x: <span class="built_in">string</span></span>) =&gt;</span> <span class="built_in">void</span>; b: <span class="function">(<span class="params">x: <span class="built_in">number</span></span>) =&gt;</span> <span class="built_in">void</span> &#125;&gt;; <span class="comment">// string &amp; number</span></span><br></pre></td></tr></table></figure>

<ul>
<li>T20 ä¸­çš„ aã€bçš„ç±»å‹éƒ½æ˜¯(x: string) =&gt; void ï¼Œæ‰€ä»¥ Bar æ¨å¯¼ x çš„ç±»å‹æ—¶ï¼ˆä¸æ˜¯éè¦ä¸åŸå‡½æ•°çš„å‚æ•°åä¸€è‡´å“ˆï¼Œä¸è¦è¯¯è§£ï¼‰ï¼ŒU éƒ½æ˜¯ stringï¼Œno doubtï¼</li>
<li>T21 ä¸­ a ä¸­ xç±»å‹æ˜¯ stringï¼Œb çš„æ˜¯ numberï¼Œä½†æ˜¯ infer çš„å‚æ•°ç±»å‹ Uéƒ½æ˜¯åŒä¸€ä¸ªï¼Œé‚£ä¹ˆæœ€ç»ˆè¯¥æ˜¯å•¥ç±»å‹ï¼Ÿå“¦ä¸å¯¹ï¼Œä¸è¯¥é—®ï¼Œä¸Šé¢éƒ½å†™äº†ã€‚ã€‚ã€‚ä¸è¿‡ä¸ºå•¥æ˜¯ string &amp; number ï¼ˆå…¶å®å°±ç­‰äº neverï¼‰å‘¢ï¼Ÿä¸ºå•¥ï¼Ÿå› ä¸ºå°±æ˜¯ts2.8ä¸­çš„ infer å°±è¿™ä¹ˆè®¾è®¡çš„ï¼ï¼ï¼</li>
</ul>
<p>è¿™é‡Œéœ€è¦å…ˆè¯´æ˜ä¸€ä¸‹ï¼šå‡½æ•°å‹ç±»å‹éƒ½å¯å½“åšæ˜¯æŠ—å˜ç±»å‹ã€‚</p>
<p>å…³äºå‡½æ•°çš„æŠ—å˜ç±»å‹ï¼Œè¿™é‡Œæœ‰ä¸ªç›¸å…³çš„è¯´æ˜ï¼š</p>
<p>â€“strictFunctionTypes æ ‡å¿—ä½ã€‚è¿™ä¸ª flag æ˜¯ <a target="_blank" rel="noopener" href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-6.html#strict-function-types">ts2.6</a> å¼•å…¥çš„ï¼Œé€šè¿‡è®¾ç½®è¯¥ä¸¥æ ¼ä½ï¼Œå°†é»˜è®¤çš„åŒå‘åå˜æ”¹ä¸ºæŠ—åå˜ã€‚å³ï¼Œé’ˆå¯¹å‡½æ•°ç±»å‹ï¼Œä¸å†ä½¿ç”¨é»˜è®¤çš„åŒå‘åå˜ã€‚ä½†æ˜¯è¿™é‡Œä¸æ˜¯è¯´ï¼Œå…³äº†è¿™ä¸ªæ ‡å¿—ä½ï¼Œä¼šå¯¹ä¸Šé¢çš„ç»“è®ºäº§ç”Ÿå½±å“ï¼Œå¹¶ä¸ä¼šï¼Œå› ä¸ºå‡½æ•°é»˜è®¤æ˜¯åŒå‘åå˜çš„ï¼Œå› æ­¤æœ¬èº«ä¹Ÿæ˜¯æŠ—å˜çš„ã€‚</p>
<p>å…³äºåŒå‘åå˜ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹é¢çš„å‚è€ƒæ¥äº†è§£ã€‚</p>
<p>æœ‰äº†ä¸Šé¢åå˜å’ŒæŠ—å˜çš„åŸºç¡€ç†è§£ï¼ŒUnionToIntersection ä»‹ç©æ„å„¿å°±å¥½ç†è§£äº†ï¼</p>
<hr>
<h2 id="UnionToIntersectionï¼ˆå¢™è£‚å»ºè®®ç…ä¸€å“ˆï¼‰"><a href="#UnionToIntersectionï¼ˆå¢™è£‚å»ºè®®ç…ä¸€å“ˆï¼‰" class="headerlink" title="UnionToIntersectionï¼ˆå¢™è£‚å»ºè®®ç…ä¸€å“ˆï¼‰"></a>UnionToIntersectionï¼ˆå¢™è£‚å»ºè®®ç…ä¸€å“ˆï¼‰</h2><p>æœ‰ç‚¹è¿œï¼ŒæŠ„ä¸€éä»£ç ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è”åˆç±»å‹æ”¹ä¸ºäº¤å‰ç±»å‹</span></span><br><span class="line"><span class="keyword">type</span> UnionToIntersection&lt;U&gt; = (U <span class="keyword">extends</span> <span class="built_in">any</span></span><br><span class="line">  ? <span class="function">(<span class="params">k: U</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  : <span class="built_in">never</span>) <span class="keyword">extends</span> (<span class="function">(<span class="params">k: infer I</span>) =&gt;</span> <span class="built_in">void</span>)</span><br><span class="line">  ? I</span><br><span class="line">  : <span class="built_in">never</span></span><br><span class="line"><span class="comment">// &#123; a: string &#125; | &#123; b: number &#125; =&gt; &#123; a: string &#125; &amp; &#123; b: number &#125;</span></span><br><span class="line"><span class="keyword">type</span> Test = UnionToIntersection&lt;&#123; <span class="attr">a</span>: <span class="built_in">string</span> &#125; | &#123; <span class="attr">b</span>: <span class="built_in">number</span> &#125;&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯ç›´æ¥è·³åˆ°è¿™çš„ï¼Œè€Œä¸”ä¸çŸ¥é“<strong>åˆ†å¸ƒå¼æ¡ä»¶çŠ¶æ€ã€ inferã€åå˜ä½ç½®ã€æŠ—å˜ä½ç½®</strong>è¿™å‡ ä¸ªè¯ï¼Œé‚£ä¹ˆè¯·ç‚¹å‡»ç›®å½•ç¨å¾®å­¦ä¹ ä¸‹~</p>
<p>// ç­‰å¾…10åˆ†é’Ÿåâ€¦â€¦</p>
<p>Thenï¼Œæˆ‘ä»¬éƒ½çŸ¥é“äº†ä¸Šé¢å‡ ä¸ªè¯çš„æ„æ€ï¼Œå¯ä»¥æ¥å‰–æè¿™ä¸ªå·¥å…·ç±»äº†ï¼š</p>
<ol>
<li>U extends any ? é‚£å¿…é¡»æ»´å•Šï¼TS ä¸­å•¥éƒ½å¯ä»¥å©šé…ç»™ anyï¼æ‰€ä»¥ï¼Œç°åœ¨å˜æˆäº†ï¼š(k: U) =&gt; void extends ((k: infer I) =&gt; void) ? I : never</li>
<li>è¿”å›ç±»å‹ = Iâ€™ =&gt; {a: string} | Iâ€™â€™ =&gt; {b: number} ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œä¸æ˜¯åˆ†å¸ƒå¼æ¡ä»¶ç±»å‹ï¼Œåˆ†å¸ƒå¼æ¡ä»¶ç±»å‹éœ€è¦çš„æ˜¯è£¸ç±»å‹ï¼‰</li>
<li>æ­¤æ—¶ Iè¢«æ¨å¯¼å‡ºä¸¤ä¸ªç±»å‹ï¼æ€ä¹ˆå¤„ç†ï¼Ÿç¬¬1æ­¥ä¸­ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå®ƒæŠŠæœ¬èº«æ˜¯å¯¹è±¡ç±»å‹çš„ç±»å‹{ a: string } | { b: number } è½¬ä¸ºäº†ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ç±»å‹ï¼Œæ²¡æ¯›ç—…å§ï¼Ÿä»ä¸€ä¸ªå‡½æ•°æ¨å¯¼ç±»å‹ï¼Œæ˜¯æ»¡è¶³æŠ—å˜ä½ç½®æ¨å¯¼çš„ï¼Œå¯¹å§ï¼ŸæŠ—å˜ä½ç½®æ¨å¯¼ï¼Œæœ€ç»ˆç±»å‹æ˜¯ï¼šæ²¡é”™ï¼Œä½ ç­”å¯¹äº†ï¼Œæ˜¯äº¤é›†ï¼æ‰€ä»¥æœ€ç»ˆè¿”å›ç±»å‹ = Iâ€™ =&gt; {a: string} &amp; Iâ€™â€™ =&gt; {b: number} = {a: string} &amp; {b: number} = {a: string; b: number}</li>
</ol>
<p>ä¸Šé¢çš„åˆ†æå¯ä»¥æ­é…ï¼š<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/50374908/transform-union-type-to-intersection-type/50375286#50375286">https://stackoverflow.com/questions/50374908/transform-union-type-to-intersection-type/50375286#50375286</a> ä¸€èµ·çœ‹çœ‹ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ç¥é©¬æ˜¯åå˜ä¸æŠ—åå˜ï¼šwhat-are-covariance-and-contravariance</p>
<p>ts ä¸­çš„åå˜ã€æŠ—å˜ã€åŒå˜ï¼Œä¸å˜æ˜¯ç¥é©¬ï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/143054881">https://zhuanlan.zhihu.com/p/143054881</a></p>
<p>ts ç–‘éš¾æ‚ç—‡ï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/82459341">https://zhuanlan.zhihu.com/p/82459341</a></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E6%B3%9B%E5%9E%8B/" rel="tag"># æ³›å‹</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/12/09/%E5%AE%BD%E9%AB%98-%E9%99%90%E5%88%B6/" rel="prev" title="å®½é«˜?é™åˆ¶?">
                  <i class="fa fa-chevron-left"></i> å®½é«˜?é™åˆ¶?
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/02/10/%E6%88%91%E8%83%BD%E7%94%A8Nodejs%E6%9D%A5%E5%81%9A%E5%90%8E%E7%AB%AF%E5%90%97/" rel="next" title="æˆ‘èƒ½ç”¨Nodejsæ¥åšåç«¯å—?">
                  æˆ‘èƒ½ç”¨Nodejsæ¥åšåç«¯å—? <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="lv-container" data-id="city" data-uid="MTAyMC81MjY5OS8yOTE3Ng=="></div><script src="/js/comments.js"></script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2018 â€“ 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class=""></i>
  </span>
  <span class="author" itemprop="copyrightHolder">è°­æ™ºè½©</span>
</div>

    </div>
  </footer>

  
  <script src="https://cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  




<script src="/js/third-party/comments/livere.js"></script>

</body>
</html>
